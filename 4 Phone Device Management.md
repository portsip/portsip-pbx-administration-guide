# 4 话机设备管理
## 4.1 话机自动配置
安装完后[PortSIP PBX](https://www.portsip.com/portsip-pbx/)，你可以设置你的IP话机并给每个话机分配一个分机号码。

话机可以通过Web界面逐一手动配置，这很耗时，而且会导致很多错误；或者使用PortSIP PBX提供的话机自动配置功能，这使得集中和远程管理话机成为可能，而无需逐一登录话机的Web界面。使用这种方法，你可以指示话机从PortSIP PBX中检索其配置。

话机自动配置大大简化了IP话机的日常管理。它使改变话机密码、BLF灯等变得很容易，因为你可以从[PortSIP PBX](https://www.portsip.com/portsip-pbx/)Web页面集中对所有话机进行修改，然后将修改推送给话机。支持以下配置方法：
- 即插即用 - 支持的IP话机可以使用即插即用自动配置（适用于本地LAN上的话机）
- 通过RPS - 对于Fanvil、Yealink ALE和Htek IP话机，可以通过RPS进行配置
- 通过手动配置URL - 支持的IP话机可以通过在话机的Web界面上输入配置URL进行配置（适用于本地、远程和SBC分机）
### 通过使用即插即用配置话机（适用于本地LAN）
**注意**：即插即用配置要求PortSIP PBX使用**默认的5060 sip端口**，并且IP话机与PortSIP PBX位于同一个本地LAN子网。

![](https://4230641821-files.gitbook.io/~/files/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-MfkamWLaD5pcQwlKWwC%2Fuploads%2F7gYbZl1vKIMoJR0InjRA%2Fphone_pnp.png?alt=media&token=78c25ee7-afdb-4641-81ff-61aa85ade3cb)

要使用即插即用的方式自动配置话机：
1. 将话机接入网络
2. 话机会在局域网内发送一个广播信息，这个信息会被PortSIP PBX服务器接收到
3. 该话机将作为一个新的话机，显示在租户的"**通话管理 > 话机**"页面
4. 选择话机分配给现有的分机号码，或者为话机创建一个新的分机号码
5. 进入分机的"**话机自动配置**"界面，为话机指定其他配置
6. 输入访问IP**话机网页密码**
7. 为话机选择"**显示语言**"和"**时区**"
8. 点击"确定"按钮
9. PortSIP PBX将话机配置文件的URL发送给IP话机，IP话机会自动下载配置文件
10. 话机将应用这些设置并连接到 PortSIP PBX。该IP话机可以在PortSIP PBX中进行管理

### 使用 配置链接 手动配置话机
如果远程话机与PortSIP PBX不在同一个局域网内，并且不能广播SIP信息，则必须通过配置链接手动配置。要配置一个远程话机：
1. 在 PortSIP PBX 租户的"**通话管理 > 话机**"页面，点击"添加话机"按钮
2. 选择该话机使用的分机号码
3. 输入话机的MAC地址（可以在话机的底部找到）
4. 从下拉框中选择合适的话机型号
5. 为话机选择"**显示语言**"和"**时区**"
6. 输入访问话机web页面的**话机网页密码**
7. 点击 "确定"按钮
8. 编辑这个分机号码，进入"**话机自动配置**"界面，点击"*配置链接*"后面的"*复制*"按钮
9. 将配置链接粘贴到话机中

### 通过RPS配置远程话机
在PortSIP PBX部署在云服务器的情况下，IP话机可以通过RPS（RPS是由IP话机供应商提供的服务）进行自动配置。PortSIP PBX支持Fanvil、Yealink和Htek的RPS。如果你使用的是上述供应商的IP话机，你可以用非常简单的方式配置你的IP话机，不需要手动复制配置链接（在这种情况下，PnP模式是不可用的）。

![](https://4230641821-files.gitbook.io/~/files/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-MfkamWLaD5pcQwlKWwC%2Fuploads%2FrkxUxi8CmrVQCdW6vTc5%2Frps.png?alt=media&token=d5c7fb50-87b4-47be-94ee-21ea3fec8c40)

1. 在 PortSIP PBX 租户的 "**通话管理 > 话机**"页面，点击"添加话机"按钮
2. 选择该话机使用的分机号码
3. 输入话机的MAC地址（可以在话机的底部找到）
4. 从下拉框中选择合适的话机型号
5. 为话机选择"**显示语言**"和"**时区**"
6. 输入访问话机web页面的**话机网页密码**
7. 打开 "**保存到RPS**"选项
8. 点击 "OK"按钮，PortSIP PBX将把配置链接写入IP话机的RPS中。当IP话机开机时，它将使用其MAC地址从RPS服务器查询配置链接，以完成自动配置。

## 4.2 管理话机
[PortSIP PBX](https://www.portsip.com/portsip-pbx/)提供了一个简单的方法来监控和管理整个网络中的话机和softphones。通过[PortSIP PBX](https://www.portsip.com/portsip-pbx/)租户的"**通话管理 > 话机**"页面，您可以：
1. 查看网络中的所有话机，包括IP和MAC
2. 查看所有以softphones模式连接的PortSIP客户端
3. 检查话机所运行的固件版本
4. 远程重启一部或全部话机
5. 重新配置话机
5. 启动话机的管理界面
6. 监控话机密码的安全性。弱话机密码是安全漏洞的最常见原因

### 添加话机
您可以通过以下方式向[PortSIP PBX](https://www.portsip.com/portsip-pbx/)添加话机：
- 即插即用 - 在本地局域网中接入话机
- 通过MAC - 适用于传统的话机
- 通过RPS - 用于远程话机

#### 即插即用 (LAN )
如果你连接的话机与[PortSIP PBX](https://www.portsip.com/portsip-pbx/)在同一个局域网内，你会看到该话机显示在租户的 "**通话管理 > 话机**"页面。这意味着[PortSIP PBX](https://www.portsip.com/portsip-pbx/)在网络上检测到了一个新的话机，你需要进行处理。

选择该话机并决定： 
1. 把话机分配到一个现有的分机号码。点击 "**指定分机**"按钮，选择话机使用的分机号码
2. 为该话机创建一个新的分机号码。点击 "**添加分机**"按钮。进入创建分机号码页面，并输入分机名称和号码等。点击"确定"，成功创建分机号码
3. 拒绝该话机。如果你觉得这个话机不熟悉，或者它没有被授权在PortSIP PBX上使用，你可以点"**拒绝**"按钮，删除配置请求

#### 通过RPS配置远程分机
如果你要添加远程安装的话机，也就是云服务器的[PortSIP PBX](https://www.portsip.com/portsip-pbx/)，你必须：
1. 在租户的"**通话管理  > 话机**"页面中，点击 "**添加话机**"按钮
2. 选择这个话机使用的分机号码
3. 选择话机的型号
4. 输入设备的MAC地址，然后点击"**确定**"按钮
5. 你可以选择配置该话机的其他设置
6. 打开 "**保存到RPS**"选项
7. 完成后，点击"**OK**"，将话机添加到分机号码上
8. 现在PortSIP PBX将把配置链接写入IP话机的RPS中。一旦IP话机启动，它将从RPS获得链接，自动从PortSIP PBX下载配置文件。**注意：目前PortSIP PBX只支持Fanvil，Yealink和Htek的PRS**，如果你的IP话机不是由他们提供的，请按照步骤9操作
9. 复制配置链接并粘贴到你的IP话机中

#### 更改话机设置
从"**用户**"的"**话机自动配置**"界面中或分机的其他"**设置**"界面中，对话机配置进行的更改将在**24小时内生效**。你可以重新配置话机，使它们立即接受新的配置。如果你需要重新配置话机，例如在你做了配置更改之后：
1. 在租户的"**通话管理  > 话机**"页面中，选择你想重新配置的话机
2. 点击"**重新配置话机**"按钮
3. 如果话机需要重启，它将自动完成
